datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

// Define table models
model buku {
  buku_id             Int                 @id @default(autoincrement())
  judul_buku          String              @unique @db.VarChar(100)
  tahun_terbit        Int
  deskripsi           String              @default("-") @db.VarChar(500)
  jumlah_halaman      Int
  waktu_peminjaman    Int                 @default(7)
  cover_buku          String
  detail_peminjaman   detail_peminjaman[]
  detail_penulis_buku detail_penulis_buku[]
}

model detail_peminjaman {
  detail_peminjaman_id Int        @id @default(autoincrement())
  status               Int        @default(0)
  buku_id              Int
  peminjaman_id        Int
  staff_id             Int
  buku                 buku       @relation(fields: [buku_id], references: [buku_id])
  peminjaman           peminjaman @relation(fields: [peminjaman_id], references: [peminjaman_id])
  staff                staff      @relation(fields: [staff_id], references: [staff_id])
}

model detail_penulis_buku {
  buku_id      Int
  penulis_id   Int
  keterangan   String?      @default("-") @db.VarChar(100)
  buku         buku         @relation(fields: [buku_id], references: [buku_id])
  penulis_buku penulis_buku @relation(fields: [penulis_id], references: [penulis_id])
  @@id([buku_id, penulis_id])
}

model peminjaman {
  peminjaman_id        Int                @id @default(autoincrement())
  nim_peminjam         BigInt
  tanggal_peminjaman   DateTime           @default(now())
  tanggal_pengembalian DateTime
  detail_peminjaman    detail_peminjaman[]
}

model penulis_buku {
  penulis_id          Int                 @id
  nama_lengkap        String              @db.VarChar(50)
  detail_penulis_buku detail_penulis_buku[]
}

model staff {
  staff_id          Int                @id @default(autoincrement())
  nama_lengkap      String             @db.VarChar(50)
  no_telp           String             @db.VarChar(15)
  tanggal_lahir     DateTime
  tanggal_masuk     DateTime           @default(now())
  alamat            String             @db.VarChar(150)
  kota              String             @db.VarChar(50)
  email             String             @unique
  password          String             @db.VarChar(100)
  detail_peminjaman detail_peminjaman[]
}
